<div class="container-fluid">
    <div class="float-left" (click)="openModal(modalAddUser,'modal')">
        <div class="card-container">
            <div class="card card-small">
                <mat-icon color="primary">add</mat-icon>
                <span class="p-2">Registrar</span>
            </div>
        </div>
    </div>

    <table class="table">
        <thead class="bg-dark text-white">
            <tr>
                <th scope="col">Nombres</th>
                <th scope="col">Apellidos</th>
                <th scope="col">Teléfono</th>
                <th scope="col">Correo</th>
                <th> </th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let us of usuarios" class="hover-tr">
                <td>{{ us.nombres }}</td>
                <td>{{ us.apellidos }}</td>
                <td>{{ us.telefono }}</td>
                <td>{{ us.correo }}</td>
                <td>
                    <button type="button" class="btn movement">
                        <mat-icon color="primary" (click)="editUser(us.id,modalUpdateUser)" class="btn-group"
                            role="group">mode_edit
                        </mat-icon>
                    </button>
                    <button type="button" class="btn movement">
                        <mat-icon color="warn"
                            (click)="confirmDeleteUser(us.id,us.nombres,us.apellidos,modalDeleteUser)" class="btn-group"
                            role="group">
                            delete
                        </mat-icon>
                    </button>
                    <a [routerLink]="['/edit', { usuario: us.id }]" class="btn movement">
                        <mat-icon color="accent" class="btn-group" role="group">
                            search
                        </mat-icon>
                    </a>
                </td>
            </tr>
        </tbody>
    </table>

    <!-- MODALES -->


    <!-- modal para agregar un usuario-->
    <ng-template #modalAddUser let-modal>
        <div class="modal-header">
            <h3 class="modal-title">Registrar usuario</h3>
            <button type="button" class="close" aria-label="Close" (click)="closeModal()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group row">
                <mat-form-field class="example-full-width col-sm-6 mb-3 mb-sm-0">
                    <mat-label>Nombres</mat-label>
                    <input matInput [(ngModel)]="userAdd.nombres" value="nombres">
                </mat-form-field>
                <mat-form-field class="example-full-width col-sm-6">
                    <mat-label>Apellidos</mat-label>
                    <input matInput [(ngModel)]="userAdd.apellidos" value="apellidos">
                </mat-form-field>
            </div>
            <div class="form-group row">
                <mat-form-field class="example-full-width col-sm-12">
                    <mat-label>Correo electrónico</mat-label>
                    <input type="email" matInput [(ngModel)]="userAdd.correo" value="correo">
                </mat-form-field>
            </div>
            <div class="form-group row">
                <mat-form-field class="example-full-width col-sm-6 mb-3 mb-sm-0">
                    <mat-label>Clave</mat-label>
                    <input type="password" matInput #clave minlength="5" [(ngModel)]="userAdd.clave" value="clave">
                    <mat-hint align="end">{{clave.value.length}} / 6</mat-hint>
                </mat-form-field>
                <mat-form-field class="example-full-width col-sm-6 mb-3 mb-sm-0">
                    <mat-label>Teléfono</mat-label>
                    <input type="text" matInput #telefono maxlength="12" [(ngModel)]="userAdd.telefono" value="telefono">
                    <mat-hint align="end">{{telefono.value.length}} / 12</mat-hint>
                </mat-form-field>
            </div>
            <div class="form-group">
                <mat-form-field class="col-sm-12 mb-3 mb-sm-0">
                    <mat-label>Rol</mat-label>
                    <select class="form-select" matNativeControl [(ngModel)]="userAdd.Idrol" name="Idrol">
                            <option class="form-control" *ngFor="let rol of roles" value="{{rol.Idrol}}">
                                {{rol.cargo}}
                            </option>
                    </select>
                </mat-form-field>

                <mat-form-field class="col-sm-12">
                    <mat-label>Area</mat-label>
                    <select class="form-select" matNativeControl [(ngModel)]="userAdd.IdArea" name="IdArea">
                        <option class="form-control" *ngFor="let area of areas" value="{{area.IdArea}}">
                            {{area.area}}
                        </option>
                    </select>
                </mat-form-field>
            </div>
        </div>
        <div class="modal-footer">
            <button class="card card-small btn bg-light" (click)="closeModal()">
                <span class="p-2">Cancelar</span>
            </button>
            <button class="card card-small btn btn-primary bg-primary" (click)="addUser(userAdd)">
                <span class="p-2">Registrar</span>
            </button>
        </div>
    </ng-template>

    <!-- modal para actualizar un usuario-->
    <ng-template #modalUpdateUser let-modal>
        <div class="modal-header">
            <h3 class="modal-title">Actualizar usuario</h3>
            <button type="button" class="close" aria-label="Close" (click)="closeModal()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group row">
                <mat-form-field class="example-full-width col-sm-6 mb-3 mb-sm-0">
                    <mat-label>Nombres</mat-label>
                    <input matInput [(ngModel)]="userUpdate.nombres" value="nombres">
                </mat-form-field>
                <mat-form-field class="example-full-width col-sm-6">
                    <mat-label>Apellidos</mat-label>
                    <input matInput [(ngModel)]="userUpdate.apellidos" value="apellidos">
                </mat-form-field>
            </div>
            <div class="form-group row">
                <mat-form-field class="example-full-width col-sm-6">
                    <mat-label>Correo alternativo</mat-label>
                    <input type="email" matInput [(ngModel)]="userUpdate.correoalternativo" value="correo">
                </mat-form-field>
                <mat-form-field class="example-full-width col-sm-6 mb-3 mb-sm-0">
                    <mat-label>Teléfono</mat-label>
                    <input type="text" matInput #telefono maxlength="12" [(ngModel)]="userUpdate.telefono" value="telefono">
                    <mat-hint align="end">{{telefono.value.length}} / 12</mat-hint>
                </mat-form-field>
            </div>

        </div>
        <div class="modal-footer">
            <button class="card card-small btn bg-light" (click)="closeModal()">
                <span class="p-2">Cancelar</span>
            </button>
            <button class="card card-small btn btn-primary bg-primary" (click)="updateUser(userUpdate)">
                <span class="p-2">Actualizar</span>
            </button>
        </div>
    </ng-template>

    <!-- modal para eliminar un usuario-->
    <ng-template #modalDeleteUser let-modal>
        <div class="modal-header">
            <h3 class="modal-title">Eliminar usuario</h3>
            <button type="button" class="close" aria-label="Close" (click)="closeModal()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            Confirma eliminar a: <b> {{ uselimina }} </b> no podra deshacer los cambios.
        </div>
        <div class="modal-footer">
            <button class="card card-small btn bg-light" (click)="closeModal()">
                <span class="p-2">Cancelar</span>
            </button>
            <button class="card card-small btn btn-danger bg-danger" (click)="deleteUser()">
                <span class="p-2">Eliminar</span>
            </button>
        </div>
    </ng-template>

</div>